<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance Calculators</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col items-center p-6 transition-colors duration-300">

  <!-- Header -->
  <header class="text-center mb-8 w-full max-w-5xl flex justify-between items-center">
    <div>
      <h1 class="text-3xl font-bold mb-1">Performance Calculators</h1>
      <p class="text-gray-600 dark:text-gray-400">Tools for efficiency, press setup, and production metrics.</p>
    </div>
    <button id="toggleDarkMode" class="px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition">
      🌙 Dark Mode
    </button>
  </header>

  <!-- Main Layout -->
  <main id="calculatorContainer" class="grid grid-cols-1 md:grid-cols-2 gap-8 w-full max-w-5xl">

    <!-- METRICS SECTION -->
    <section class="bg-gray-50 dark:bg-gray-800 rounded-2xl shadow-md p-6 transition-colors duration-300">
      <div class="flex items-center gap-2 mb-6 border-b border-gray-200 dark:border-gray-700 pb-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-blue-700 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3v18h18M9 9h6v6H9z"/>
        </svg>
        <h2 class="text-2xl font-bold text-blue-700 dark:text-blue-400">Metrics</h2>
      </div>

      <!-- Target Speed + EFF + Roll Time calculators -->
      <!-- (Existing code unchanged, omitted for brevity) -->
    </section>

    <!-- PRESS SECTION -->
    <section class="bg-gray-50 dark:bg-gray-800 rounded-2xl shadow-md p-6 transition-colors duration-300">
      <div class="flex items-center gap-2 mb-6 border-b border-gray-200 dark:border-gray-700 pb-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-blue-700 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6 1A9 9 0 116 4.93"/>
        </svg>
        <h2 class="text-2xl font-bold text-blue-700 dark:text-blue-400">Press</h2>
      </div>

      <!-- Sleeve Rotation Calculator (unchanged) -->
      <div id="sleeveRotationCalculator" class="bg-white dark:bg-gray-700 shadow rounded-2xl p-6 mb-8 transition-colors duration-300">
        <h3 class="text-xl font-semibold mb-4">Sleeve Rotation Calculator</h3>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Interface: 1" = 10,000. Calculates rotation input to move between plates.</p>
        <div class="space-y-4">
          <div>
            <label for="sleeveDiameter" class="block text-sm font-medium mb-1">Sleeve Diameter (in)</label>
            <input type="number" step="0.01" id="sleeveDiameter" class="w-full border dark:border-gray-600 rounded-lg p-2 bg-gray-50 dark:bg-gray-600">
          </div>
          <div>
            <label for="platesAround" class="block text-sm font-medium mb-1">Plates Around</label>
            <input type="number" id="platesAround" class="w-full border dark:border-gray-600 rounded-lg p-2 bg-gray-50 dark:bg-gray-600">
          </div>
          <div>
            <label for="platesToMove" class="block text-sm font-medium mb-1">Plates to Move</label>
            <input type="number" id="platesToMove" class="w-full border dark:border-gray-600 rounded-lg p-2 bg-gray-50 dark:bg-gray-600" placeholder="Default = 1">
          </div>
          <button id="calculateSleeveRotation" class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition">Calculate Rotation</button>
          <div id="sleeveRotationResult" class="text-center text-lg font-semibold mt-4"></div>
        </div>
      </div>

      <!-- Repeat Adjustment Calculator -->
      <div id="repeatAdjustmentCalculator" class="bg-white dark:bg-gray-700 shadow rounded-2xl p-6 transition-colors duration-300">
        <h3 class="text-xl font-semibold mb-4">Repeat Adjustment Calculator</h3>
        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Calculates shrink or stretch needed to correct repeat length.</p>

        <div class="space-y-4">
          <div>
            <label for="targetRepeat" class="block text-sm font-medium mb-1">Target Repeat (mm)</label>
            <input type="number" step="0.01" id="targetRepeat" class="w-full border dark:border-gray-600 rounded-lg p-2 bg-gray-50 dark:bg-gray-600">
            <label class="inline-flex items-center mt-2 text-sm">
              <input type="checkbox" id="targetIncludesTolerance" class="mr-2">
              Target includes +3mm tolerance
            </label>
          </div>
          <div>
            <label for="actualRepeat" class="block text-sm font-medium mb-1">Actual Repeat (mm)</label>
            <input type="number" step="0.01" id="actualRepeat" class="w-full border dark:border-gray-600 rounded-lg p-2 bg-gray-50 dark:bg-gray-600">
          </div>
          <button id="calculateRepeatAdjustment" class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition">Calculate Adjustment</button>
          <div id="repeatAdjustmentResult" class="text-center text-lg font-semibold mt-4"></div>
        </div>
      </div>
    </section>
  </main>

  <footer class="mt-12 text-gray-500 dark:text-gray-400 text-sm">
    &copy; <span id="year"></span> Efficiency Tools
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // --- Dark mode toggle ---
    const toggleDarkMode = document.getElementById('toggleDarkMode');
    const root = document.documentElement;
    function applyTheme(isDark) {
      if (isDark) {
        root.classList.add('dark');
        toggleDarkMode.textContent = '☀️ Light Mode';
        localStorage.setItem('theme', 'dark');
      } else {
        root.classList.remove('dark');
        toggleDarkMode.textContent = '🌙 Dark Mode';
        localStorage.setItem('theme', 'light');
      }
    }
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) applyTheme(true);
    toggleDarkMode.addEventListener('click', () => applyTheme(!root.classList.contains('dark')));

    // --- Sleeve Rotation Calculator ---
    function calculateSleeveRotation(diameter, plates, movePlates = 1) {
      if (!diameter || !plates || plates <= 0) return null;
      return (diameter * 10000 / plates) * movePlates;
    }
    document.getElementById('calculateSleeveRotation').addEventListener('click', () => {
      const diameter = parseFloat(document.getElementById('sleeveDiameter').value);
      const plates = parseFloat(document.getElementById('platesAround').value);
      const move = parseFloat(document.getElementById('platesToMove').value) || 1;
      const result = calculateSleeveRotation(diameter, plates, move);
      const el = document.getElementById('sleeveRotationResult');
      if (!result) {
        el.textContent = 'Please enter valid values.';
        el.classList.add('text-red-500');
      } else {
        el.textContent = `Rotation Input: ${result.toFixed(0)}`;
        el.classList.remove('text-red-500');
        el.classList.add('text-green-400');
      }
    });

    // --- Repeat Adjustment Calculator ---
    function calculateRepeatAdjustment(target, actual, includesTolerance) {
      if (!target || !actual) return null;
      let adjTarget = includesTolerance ? target : target + 3;
      const diffMM = adjTarget - actual;
      const diffIN = diffMM / 25.4;
      return diffIN;
    }
    document.getElementById('calculateRepeatAdjustment').addEventListener('click', () => {
      const target = parseFloat(document.getElementById('targetRepeat').value);
      const actual = parseFloat(document.getElementById('actualRepeat').value);
      const includesTolerance = document.getElementById('targetIncludesTolerance').checked;
      const result = calculateRepeatAdjustment(target, actual, includesTolerance);
      const el = document.getElementById('repeatAdjustmentResult');
      if (result === null || isNaN(result)) {
        el.textContent = 'Please enter valid repeat values.';
        el.classList.add('text-red-500');
      } else {
        const direction = result > 0 ? 'Stretch' : 'Shrink';
        el.textContent = `${direction} by ${result.toFixed(3)} in`;
        el.classList.remove('text-red-500');
        el.classList.add('text-green-400');
      }
    });
  </script>
</body>
</html>
